175. Combine Two Tables
//
select firstName,lastName,city,state from person p
left join address a
on p.personId=a.personId 

181. Employees Earning More Than Their Managers
//
select e1.name as Employee from Employee e1
join Employee e2
on e2.id=e1.managerId 
where e2.salary < e1.salary

182. Duplicate Emails
//
select email as Email from person  
group by email
having count(email)>1

183. Customers Who Never Order
select name as Customers from Customers 
where id not in(select customerId from Orders)

196. Delete Duplicate Emails
//
delete from person
where id not in(select min(id) from person group by email)

197. Rising Temperature
//
select w1.id from Weather w1,Weather w2
where w2.recordDate = dateadd(day,-1,w1.recordDate)
and w2.temperature < w1.temperature 

511. Game Play Analysis I
//
select  player_id,min(event_date) as first_login  from Activity
group by player_id

577. Employee Bonus
//
select e.name,b.bonus from Employee e
left join Bonus b
on e.empId=b.empId 
where b.bonus < 1000 or b.bonus is null 

584. Find Customer Referee
//
select name from Customer 
where referee_id <>2 or referee_id is null

586. Customer Placing the Largest Number of Orders
//
select top 1 customer_number from Orders 
group by customer_number 
order by count((customer_number)) desc

595. Big Countries
//
select name, population,area from World
where area>=3000000 or population >=25000000

596. Classes More Than 5 Students
//
select class from Courses 
group by class
having count(student)>5

1661. Average Time of Process per Machine
//
select a1.machine_id ,round(avg(a2.timestamp -a1.timestamp ),3) as processing_time 
from Activity a1
inner join Activity a2
on a1.process_id =a2.process_id 
and a1.machine_id=a2.machine_id 
and a2.timestamp >a1.timestamp 
group by a1.machine_id 

1934. Confirmation Rate
//
select s.user_id,round(cast(count(case when action='confirmed' then 1 else null end)as float)/count(*),2) as confirmation_rate 
 from Signups s
left join Confirmations c
on s.user_id =c.user_id 
group by s.user_id

570. Managers with at Least 5 Direct Reports
//
select e1.name from Employee e1
inner join Employee e2
on e1.id=e2.managerId 
group by e1.name
having count(e2.managerId)>=5

1251. Average Selling Price
//
select p.product_id,round(cast(sum(p.price*u.units)as float)/sum(u.units) ,2) as average_price
from Prices p
inner join UnitsSold u
on p.product_id=u.product_id
and purchase_date between start_date and end_date
group by p.product_id




